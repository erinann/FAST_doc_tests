= Suggested workflow to contribute to the ICES WGFAST convention documents
Erin LaBrecque
:revnumber: 0.01
:revdate: 2020-02-25
:imagesdir: images\
:toc: preamble
:toclevels: 4
ifdef::env-github[]
:tip-caption: :bulb:
:note-caption: :information_source:
:important-caption: :heavy_exclamation_mark:
:caution-caption: :fire:
:warning-caption: :warning:
endif::[]

This workflow is to help contributors who have not used Git or GitHub get started. Specifically, this file is about working with forked repositories.

If you work regularly with Git and GitHub, please read through the link:experienced_github_users.adoc[A quick workflow for experienced Git and GitHub users]. +
PS - Contributions to any of the help documents are welcome.

== Jargon
There are a few terms you should have a handle on before jumping into the deep end of Git and GitHub.

* *_Git_* - A type of version control system (software).
* *_GitHub_* - An online (in the cloud) hosting service for Git repositories. It is built on Git so a lot of the terminology will be the same between Git and GitHub.
* *_Repository_* - Also called a "repo". A repository is a folder for your project. It contains all the documents that comprise a project. Repos can have code file and scripts from any language, pictures, videos, text files (.doc, .docx, .adoc, .txt, .mb etc.), PDFs, etc.. If a file is part of a project, it goes in the repo.
* *_Clone_* (n.) / _Cloning a repo_ (v.) - A cloned repository is a copy of a repository. You usually clone a repo from GitHub (hosting service) to your local machine to work on project files locally.
* *_Fork_* (n.) / _Forking a repo_ (v.) - This is special terminology to GitHub and a few other hosting services. A fork is a cloned repository owned by someone else that you manage in your GitHub account. "Forking a repo" means to clone someone else's repository to your account. You are going to fork a copy of the `ices-eg/wg_WGFAST` repository to your own account to work on it independently before submitting any changes back to `ices-eg/wg_WGFAST`. `ices-eg` (ICES Expert Groups) is the team that owns the workspace. `wg_WGFAST` is the repository (project space) for the FAST working group.
* *_Upstream repository_* - The repository you forked from.
* *_Remote repository_* - The repository where your project is stored on GitHub.
* *_Branch_* - Branches of a repository are isolated development areas. You create a branch to work on part of a project without affecting the entire project. Every repository has one default branch, usually called `master`, and can have multiple other branches. You merge branches using a pull request.
* *_Push_* - Move changes (commits) from your local machine to a remote repository.
* *_Fetch_* - Retrieve changes from a remote repository without merging the changes into your own branch.
* *_Merge_* - Integrate the contents of the source branch into another branch.
* *_Pull_* - Fetch and merge in one step.
* *_Pull Request_* - Also called a "PR". A pull request tells others about the changes you have made (all the commits) to the project. It is called a pull request because you are asking to pull the changes from a source to a target. You can create a pull request between branches of a single repository or between branches of different repositories. +
{empty} +

image:Git_GitHub_workflow.png[]

== Workflow to contribute
Once you have installed the software, set up your GitHub account, linked Git, GitHub, and your text editor, AND have a basic understanding of the jargon listed above, you are ready to contribute to the WGFAST convention documents!
{empty} +

=== Fork the ices-eg/wg_WGFAST repository
* You only have to do this step once.
- Sign into https://github.com[GitHub] and navigate to the ICES Expert Working Group - wg_WGFAST repository at https://github.com/ices-eg/wg_WGFAST.
- Fork the repository to your account by clicking on the image:fork_button.png[] button.

image:fork_page.png[]
{empty} +
{empty} +

TIP: Forking and cloning both create a copy of a repository, but forking is not a Git function. Forking is only done in GitHub and other hosting services. You fork a repository from another account to work on a copy of that project without affecting the original project. After forking a repo, you can clone it to your local machine to work on it locally.

Once the repository is forked to your account you can either <<Editing documents in GitHub, edit the documents directly in GitHub>> or clone the repository to your computer and work locally. We suggest cloning the repo unless you are only going to fix a couple wrongs spellings.
{empty} +

=== Clone the repository to your local machine
* You only have to do this step once.
** Click on the repository to open it, then click on the clone button.

A "clone" is a Git term for a complete copy of a repository - all files and their change histories. +

//

1. Clone button.
2. Clipboard button. This places a copy of the repository's URL on your clipboard. +

image:clone_button.png[] +
{empty} +

There are several ways you can clone a repo to our local machine. +

1. Use Git:
** Open the Git command line and navigate to folder you want to deposit the repository. Use the `cd` command. How you write the `cd` command will depend on where Git starts from.
** Type: `git clone https://github.com/_YOUR-USERNAME_/_YOUR-REPOSITORY_` +

Moving from the home directory to the `research_projects` directory.
----
$ cd Documents/research_projects/
$ git clone https://github.com/erinann/wg_WGFAST
----

These commands put a folder called `wg_WGFAST` in the `research_projects` directory on erinann's local machine with all the files in the wg_WGFAST repository. +
{empty} +

[start=2]
. Download a zip file of the repository to your local machine and unzip it. +

//

[start=3]
. Use Atom or Brackets to clone a repository to your local machine.
{empty} +

=== Add the repository to a workspace in either Atom or Brackets
* You only have to do this step once. +

If you cloned the repository to your local machine using Atom or Brackets, the repository will already be in a workspace. If you downloaded and unzipped the ZIP file or cloned the repository in Git, you will need to add the repository to your workspace in either Atom or Brackets. Atom refers to repositories as "projects".

*Atom*: `File > Add Project Folder...` or `Ctrl + Shift + A` +
{empty} +

*Brackets*: `File > Open Folder...` or `Ctrl + Alt + A` +
{empty} +

=== Edit
Open an AsciiDoc document in Atom or Brackets and start editing. +
image:editing_2.jpg[height=150, width=150] +

See the link:5_plain_text_editor_help.adoc[Plain Text Editor help] file if you need help using Atom or Brackets. +
{empty} +

=== Stage and commit
After you have made a series of edits, save the document, stage it, and commit it to your local repository with a useful commit message. Staging tells Git what files have been changed and commits  It's best practice to commit often to keep a record of the changes. For example, if you finish working on an introduction section, save it and commit the document. +

TIP: Commit early and often!

*Git*:
Stage and commit all changed files
----
$ git add .
$ git commit -m "Citation updates to acmeta.adoc and ref.bib"
----

Stage and commit individual file (acmeta.adoc)
----
$ git add AcMeta/acmeta.adoc 
$ git commit -m "Update Section 6.5"
----
{empty} +

*Atom*: +
1. In the Git panel, right-click on the file and choose `Stage`. +
2. Enter a useful commit message to let people know what changes you made, and click `Commit to master`. +
{empty} +
image:atom_stage.png[]
image:atom_commit.png[] +
{empty} +

*Brackets*: +
1. Click on the box next to modified document to stage it, or click on the check box next to the `Commit` button to stage all modified documents. +
image:brackets_stage.png[] +
{empty} +
2. Click on the `Commit` button. +
image:brackets_commit_1.png[] +
{empty} +
3.  Add a message to let people know what changes you made, and click `OK`. +
image:brackets_commit_2.png[] +
{empty} +

=== Push edits to GitHub
Pushing to GitHub is how you update your remote repository. When finish editing the document and want to submit it to the working group, first push all commits to your forked repository. +

*Git*: +
----
$ git push
----
{empty} +

*Atom*: +
Click on the `Push` button. In this example, three commits will be pushed to GitHub. +
image:atom_push.png[] +
{empty} +

*Brackets*: +
Click on the `Git Push` button. +
image:brackets_push.png[] +
{empty} +

CAUTION: If you have two-factor authentication setup on GitHub (some government agencies require this) and use Brackets, you will have to use Git command line to push your commits to GitHub. Brackets does not currently support two-factor authentication options.

=== Submit a Pull Request
Once all your edits are in your repository are on GitHub, submit a pull request to `ices-eg/wg_WGFAST`. A pull request tells others about the changes you have made (all the commits), allows the convention coordinators to approve or deny the changes, and provides an area to discuss the changes if needed. It is called a pull request because you are asking the upstream repository to pull the changes from your fork. +

1. Click on `Pull request` in your `wg_WGFAST` repository.

image:GitHub_PR_1.png[] +
{empty} +

[start=2]
2. Make sure that the `master` branch of base repository (`ices-eg/wg_WGFAST`) pulls the changes from the correct branch of your repository. In most cases, it will be the `master` branch. Click on `Create pull request`. +

image:GitHub_PR_2.png[] +
{empty} +

Once your pull request has been submitted, a convention coordinator will be notified and will review your edits. Your edits will either be merged into the `ices-eg/wg_WGFAST` master branch or a coordinator might reply back to you asking to clarify or update text.
{empty} +

== Updating your forked repository
When you create a fork of a repository you only have the version of the files that are in the repository at that time. Assume you made corrections and edits to the metadata convention document and submitted a pull request that was accepted. A couple days later several other contributors submit pull requests that were accepted. Now you have an old copy of the forked repository and are out of sync with the upstream repo. To update your forked repository you have to "synchronize your fork", also known as "getting upstream updates".

*Git*: +
1. Make sure you are in the current working directory of your local project. +
2. Configure the remote repository. This tells Git where it needs to look. +

** First, list the current configured remote repository for your fork. +
----
$ git remote -v
origin  https://github.com/erinann/wg_WGFAST.git (fetch)
origin  https://github.com/erinann/wg_WGFAST.git (push)
----
** Then specify the `ices-eg/wg_WGFAST` repository as the remote upstream repository. +
----
$ git remote add upstream https://github.com/ices-eg/wg_WGFAST.git
----
** Verify the new upstream repository for the fork.
----
$ git remote -v
origin  https://github.com/erinann/wg_WGFAST.git (fetch)
origin  https://github.com/erinann/wg_WGFAST.git (push)
upstream        https://github.com/ices-eg/wg_WGFAST.git (fetch)
upstream        https://github.com/ices-eg/wg_WGFAST.git (push)
----
3. Fetch the commits from the upstream repository.
----
$ git fetch upstream
----
4. Check out the branch you want to put the commits in. This is usually the `master` branch of your local forked repo.
----
$ git checkout master
----
5. Merge the `upstream/master` int oyour local `master` to brink your fork's `master` branch in sync with the upstream repository.
----
$ git merge upstream/master
----
{empty} +


== Alternative workflow
=== Editing documents in GitHub
Editing large parts of the convention documents directly in GitHib is **not** recommended unless you are an expert in GitHub and AsciiDoc markup. +
{empty} +
The easiest way to edit a few typos, if you do not want to clone the repository to your local machine, is to edit the document directly in GitHub.

1. After <<Fork the ices-eg/WG_FAST repository, forking>> the `ices-eg/wg_WGFAST` repository to your GitHub account, open the repository and click on the file you would like to edit.
{empty} +
{empty} +
image:GitHub_edit_1.png[] +
{empty} +
2. Open the document for editing by clicking to the pencil icon.
{empty} +
{empty} +
image:GitHub_edit_2.png[] +
{empty} +
{empty} +
3. Edit the document. You can preview the changes before committing's them by clicking the `Preview changes` button.
{empty} +
{empty} +
image:GitHub_edit_3.png[] +
{empty} +
4. When you are done editing the document, provide a useful commit message and click `Commit changes`.
{empty} +
{empty} +
image:GitHub_edit_4.png[] +
{empty} +

[CAUTION]
If you cloned the repository on your local machine but made edits directly in GitHub, you will have to pull those edits to the copy on your local machine before you can push any changes back to the GitHub repository.
